<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ITCamp57 | รายละเอียดกิจกรรม</title>
  <link rel="stylesheet" href="/css/event-detail.css">
  <!-- Google Fonts: Prompt & Kanit -->
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;700&family=Kanit:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

  <!-- แถบบน -->
  <header class="topbar">
    <div class="topbar__inner">
      <nav class="links">
        <a href="/">หน้าหลัก</a>
        <a href="#">การแจ้งเตือน</a>
      </nav>
      <div class="avatar" aria-label="profile"></div>
    </div>
    
  </header>

  <main class="container">
    <h1 class="title"><%= activity.title %></h1>

    <!-- แกลเลอรีแบบเรียบๆ -->
    <section class="gallery">
      <% if (activity.images && activity.images.length) { %>
        <% activity.images.forEach(function(img) { %>
          <img src="<%= img %>" alt="ภาพกิจกรรม">
        <% }) %>
      <% } else { %>
        <img src="<%= activity.image_url %>" alt="ภาพกิจกรรม">
      <% } %>
    </section>

    <section class="detail">
      <h2 class="sub">รายละเอียดกิจกรรม</h2>
      <p class="desc"><%= activity.description %></p>
      <div class="info-grid">
        <div class="info">
          <h3>วันที่จัดกิจกรรม</h3>
          <p>
            <% function formatDate(dateStr) {
              if (!dateStr) return '';
              const d = new Date(dateStr);
              return d.toLocaleDateString('th-TH', { year: 'numeric', month: 'long', day: 'numeric' });
            } %>
            <%= formatDate(activity.start_at) %> – <%= formatDate(activity.end_at) %>
          </p>
        </div>
        <div class="info">
          <h3>วันรับสมัคร</h3>
          <p><%= formatDate(activity.reg_open_at) %> – <%= formatDate(activity.reg_close_at) %></p>
        </div>
        <div class="info">
          <h3>สถานที่จัดกิจกรรม</h3>
          <p><%= activity.location %></p>
        </div>
      </div>

      <div class="actions">
        <a class="btn" href="<%= activity.registration_url %>">สมัคร</a>
      </div>
    </section>
  </main>

  <script>
    const express = require('express');
    const router = express.Router();
    const EventModel = require('../models/event.model'); // หรือเรียก API

    router.get('/:id', async (req, res) => {
      // ดึงข้อมูลกิจกรรมจาก Model หรือ API
      const activity = await EventModel.findById(req.params.id);
      if (!activity) return res.status(404).send('ไม่พบกิจกรรม');
      // ส่งข้อมูลไป render หน้า event.ejs
      res.render('event', { activity });
    });

    module.exports = router;
  </script>
</body>
</html>
